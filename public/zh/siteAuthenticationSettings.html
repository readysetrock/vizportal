<div class="tb-tabs-banner-subplace"><div class="tb-scroll"><div class="tb-settings-container tb-settings-section"><div class="tb-site-authentication"><div class="tb-setting-group"><div class="tb-group-name">连接的客户端</div><div class="tb-group-content"><div class="tb-settings-msg">用户首次提供登录凭据后，Tableau 客户端(例如移动应用、同步客户端及其他)将保持对此站点的已验证状态。连接使用唯一标识每个用户和客户端的安全令牌建立，而不存储用户的凭据。</div><tb:checkbox-group><tb:checkbox ng-model="siteSettingsForSiteAdmin.siteAdminSettings.refreshTokenEnabled"></tb:checkbox><tb:checkbox-label>允许此 Tableau Online 站点上的连接的客户端。</tb:checkbox-label></tb:checkbox-group></div></div><div class="tb-setting-group"><div class="tb-connected-clients"></div><div class="tb-group-name">此站点的身份验证</div><div ng-if="!allowed" class="tb-settings-msg"><div ng-bind-html="contactCustomerSupport() | locLinkifier"></div></div><div class="tb-group-content"><div class="tb-static-checkmark"></div><div class="tb-checkbox-label">TableauID</div><div class="tb-checkbox-indent">所有站点的默认身份验证类型</div></div><div tb-disabled="!allowed" class="tb-group-content"><tb:checkbox-group><tb:checkbox ng-model="configuration.enabled" tb-disabled="!allowed"></tb:checkbox><tb:checkbox-label>SAML 单点登录</tb:checkbox-label><span ng-if="configuration.enabled" class="tb-enabled-color">&nbsp;-&nbsp;已启用 SAML</span><span ng-if="!configuration.enabled">&nbsp;-&nbsp;未启用 SAML</span></tb:checkbox-group><div class="tb-checkbox-indent">要启用单点登录，您必须安装有身份提供程序 (IdP)，而且它要支持 SAML 和每个用户的电子邮件地址（映射到 IdP 中的电子邮件地址）。</div><div class="tb-checkbox-indent">&nbsp;</div><div class="tb-checkbox-indent">按照下面的步骤操作，以使用 SAML 进行单点登录。</div></div></div><div tb-disabled="!isEnabled()" class="tb-site-authentication-settings"><div class="tb-setting-group"><div class="tb-group-name"><span class="tb-group-number">1</span>从 Tableau Online 中导出元数据文件</div><div class="tb-group-content">选择可获得 IdP 所需元数据的选项。<div class="tb-auth-options-list"><div class="tb-auth-options-list-item">&#x25cf;&nbsp;保存一个将包含所有必需元数据的 XML 文件。&nbsp;<input type="button" value="导出元数据" tb-button-click="download($event, configuration.serviceProviderEntityId)" tb-disabled="!isEnabled()" class="tb-outline-button"/></div><div>或</div><div class="tb-auth-options-list-item">&#x25cf;&nbsp;逐个复制 Tableau Online 实体 ID 和 ACS URL，并将 X.509 证书下载到 CER 文件。</div></div><div class="tb-auth-options-right-align"><div class="tb-auth-options-label">Tableau Online 实体 ID</div><input type="text" readonly="readonly" value="{{configuration.serviceProviderEntityId}}" tb-disabled="!isEnabled()" class="tb-url-holder"/></div><div class="tb-auth-options-right-align"><div class="tb-auth-options-label">声明使用者服务 URL (ACS)</div><input type="text" readonly="readonly" value="{{configuration.acsUrl}}" tb-disabled="!isEnabled()" class="tb-url-holder"/></div></div><div class="tb-auth-options-right-align"><input type="button" value="下载签名和加密证书" tb-button-click="download($event, configuration.certificateUrl)" tb-disabled="!isEnabled()" class="tb-outline-button"/></div></div><div class="tb-setting-group"><div class="tb-group-name"><span class="tb-group-number">2</span><span class="tb-dark-highlight">外部步骤:</span>&nbsp;将元数据文件导入 IdP</div><div class="tb-group-content">转到身份提供程序的站点，然后按照提供的说明来配置 SAML。视 IdP 而定，您将导入在步骤 1 中导出的元数据文件，或者逐个添加实体 ID、ACS URL 和证书。</div></div><div class="tb-setting-group"><div class="tb-group-name"><span class="tb-group-number">3</span><span class="tb-dark-highlight">外部步骤:</span>&nbsp;从 IdP 中导出元数据文件</div><div class="tb-group-content">从 IdP 中导出元数据文件或构建您自己的元数据文件。</div></div><div class="tb-setting-group"><div class="tb-group-name"><span class="tb-group-number">4</span>将元数据文件导入 Tableau Online</div><form action="{{endpoint}}" enctype="multipart/form-data" method="POST" target="{{iframeId}}" name="updateIdentityProviderForm" class="tb-form-indent"><tb:file-input filename-localization-key="siteAuthenticationIdPMetadataFile" name="entity_descriptor" required="required" class="tb-padded-box"></tb:file-input><input type="hidden" value="{{xsrfToken}}" name="XSRF-TOKEN"/><span class="tb-padded-box"><button type="submit" tb-disabled="!isEnabled()" translate="apply" class="tb-outline-button"></button></span><tb:upload-iframe iframe-id="iframeId" name="{{iframeId}}" handle-result="handleFormSubmitResult(result)"></tb:upload-iframe></form><div class="tb-auth-options-right-align"><div class="tb-auth-options-label">IdP 实体 ID</div><input type="text" readonly="readonly" value="{{configuration.identityProviderEntityId}}" tb-disabled="!isIdentityProviderConfigured()" class="tb-url-holder"/></div><div class="tb-auth-options-right-align"><div class="tb-auth-options-label">SSO 服务 URL</div><input type="text" readonly="readonly" value="{{configuration.ssoServiceURL}}" tb-disabled="!isIdentityProviderConfigured()" class="tb-url-holder"/></div><div ng-show="isIdentityProviderConfigured() &amp;&amp; configuration.isSingleLogoutSupported" class="tb-auth-options-left-margin">IdP 配置为支持 SAML 单点注销 (SLO)</div><div ng-show="isIdentityProviderConfigured() &amp;&amp; !configuration.isSingleLogoutSupported" class="tb-auth-options-left-margin">IdP 未配置为支持 SAML 单点注销 (SLO)</div><div class="tb-auth-options-right-align tb-label-padding"><input type="button" value="测试登录" tb-button-click="testLogin()" tb-disabled="!isIdentityProviderConfigured()" class="tb-outline-button tb-float-left tb-auth-options-left-margin"/><input type="button" value="移除身份提供程序" tb-button-click="removeIdentityProvider()" tb-disabled="!isIdentityProviderConfigured()" class="tb-outline-button"/></div></div><!-- this will be probably inside a form when the functionality is implemented--><div tb-disabled="!isIdentityProviderConfigured()" class="tb-setting-group"><div class="tb-group-name"><span class="tb-group-number">5</span>匹配声明</div><div class="tb-group-content">断言包含有关用户的身份验证和其他属性。在这里，您可以指定包含 Tableau Online 所需信息的 IdP 断言名称。您可以在 IdP 的 SAML 配置中找到断言名称。</div><div class="tb-group-content tb-auth-assertions tb-label-padding"><span class="tb-auth-table-header tb-auth-table-header-left">Tableau Online 属性</span><span class="tb-auth-table-header tb-auth-table-header-right">身份提供程序 (IdP) 声明名称</span><table><tr><td>电子邮件<br/>电子邮件地址必须匹配才能成功进行身份验证</td><td><tb:text-box tb-text-box-model="configuration.siteSAMLAttributeMapping.emailMapping" tb-disabled="!isIdentityProviderConfigured()"></tb:text-box></td></tr></table><table><tr><td colspan="3">显示名称</td></tr><tr><td colspan="3">为名字和姓氏或全名提供声明名称，具体取决于 IdP 如何存储此信息。Tableau Online 使用这些声明设置显示名称。</td></tr><tr class="tb-auth-assertion-grouping"><td rowspan="2" class="tb-auth-assertions-radio"><input type="radio" name="assertion" tb-disabled="!isIdentityProviderConfigured()" ng-model="configuration.siteSAMLAttributeMapping.useFullName" ng-value="false"/></td><td class="tb-auth-assertions-radio-label">名</td><td><tb:text-box tb-text-box-model="configuration.siteSAMLAttributeMapping.firstNameMapping" tb-disabled="!isIdentityProviderConfigured() || configuration.siteSAMLAttributeMapping.useFullName"></tb:text-box></td></tr><tr class="tb-auth-assertion-grouping"><td class="tb-auth-assertions-radio-label">姓</td><td><tb:text-box tb-text-box-model="configuration.siteSAMLAttributeMapping.lastNameMapping" tb-disabled="!isIdentityProviderConfigured() || configuration.siteSAMLAttributeMapping.useFullName"></tb:text-box></td></tr><tr><td colspan="3"></td></tr><tr class="tb-auth-assertion-grouping"><td class="tb-auth-assertions-radio"><input type="radio" name="assertion" tb-disabled="!isIdentityProviderConfigured()" ng-model="configuration.siteSAMLAttributeMapping.useFullName" ng-value="true"/></td><td class="tb-auth-assertions-radio-label">全名</td><td><tb:text-box tb-text-box-model="configuration.siteSAMLAttributeMapping.fullNameMapping" tb-disabled="!isIdentityProviderConfigured() || !configuration.siteSAMLAttributeMapping.useFullName"></tb:text-box></td></tr></table><div class="tb-auth-options-right-align"><button type="submit" tb-disabled="!isEnabled()" translate="apply" tb-button-click="setSiteAttributeMapping()" class="tb-outline-button"></button></div></div></div><div tb-disabled="!isIdentityProviderConfigured()" class="tb-setting-group"><div class="tb-group-name"><span class="tb-group-number">6</span>选择用户</div><div class="tb-group-content">指定哪些用户可使用 SAML 登录</div><div class="tb-group-content tb-users"><table><tr><td class="tb-users-link"><a ui-sref="main.site.users">查看用户</a></td><td>&nbsp;-&nbsp;从 Tableau Online 用户列表中选择用户</td></tr><tr><td class="tb-users-link"><a ng-click="openAddExternalUsersDialog($event)">添加用户</a></td><td>&nbsp;-&nbsp;输入新用户的电子邮件地址</td></tr></table></div></div><div tb-disabled="!isIdentityProviderConfigured()" class="tb-setting-group"><div class="tb-group-name"><span class="tb-group-number">7</span>向 Tableau Online 进行身份验证</div><div class="tb-group-content">获得批准的用户现在可使用单点登录来访问 Tableau Online<br/>如果用户遇到身份验证问题，您可以通过执行以下操作来解决他们的问题:<div class="tb-auth-options-list"><div class="tb-auth-options-list-item">&#x25cf;&nbsp;解决声明匹配问题(步骤 5)&nbsp;<input type="button" value="下载日志文件" tb-button-click="download($event, downloadLogUrl())" tb-disabled="!isIdentityProviderConfigured()" class="tb-outline-button"/></div><div class="tb-auth-options-list-item">&#x25cf;&nbsp;将数据、证书从在线重新导出到 IdP (步骤 1-3)</div><div class="tb-auth-options-list-item">&#x25cf;&nbsp;重新加载新元数据文件(步骤 4)</div></div><div>通过清除此页面顶部的“SAML 单点登录”复选框来禁用 SAML</div></div></div></div></div></div></div></div>
<div class="tb-details"><div class="tb-details-header"><div class="tb-details-header-main"><div class="tb-details-header-title">{{ datasource.connectionTypeDisplayName }}</div><div class="tb-details-header-extract"><span ng-show="datasource.lastRefreshedAt" class="tb-icon-datasource-extract"></span><span ng-show="datasource.lastRefreshedAt">数据提取</span><span ng-show="!datasource.lastRefreshedAt">实时连接</span></div></div><div ng-if="datasource.lastRefreshedAt" class="tb-details-header-sub"><span class="tb-details-header-label">上次数据提取刷新时间:</span><span>{{ datasource.lastRefreshedAt | localizedDateTime }}</span><button ng-if="allowedAction('refreshExtract')" tb-button-click="refreshNow($event)" tb-disabled="requestRefreshNowIsDisabled()" class="tb-outline-button tb-margin-left-wide">立即刷新</button></div></div><table ng-if="datasource.connectionDetails.type === 'file'"><tbody><tr><td class="tb-label">文件名</td><td ng-if="datasource.connectionDetails.fileName" ng-class="{'tb-missing-value': !datasource.connectionDetails.fileName }" class="tb-details-value">{{ datasource.connectionDetails.fileName || ('filenameUnavailable' | translate) }}</td><td ng-if="!datasource.connectionDetails.fileName" class="tb-details-value">文件名不可用</td></tr></tbody></table><table ng-if="datasource.connectionOAuth"><tbody><tr><td class="tb-label">身份验证</td><td class="tb-details-value"><div ng-if="dataConnectionIsReading()" ng-switch="oauthInitialEditModel.credentialOption"><div ng-switch-when="password" ng-if="allowOAuthWithPassword"><div>嵌入连接中的 Salesforce 用户名和密码</div><div>{{ datasource.connectionDetails.databaseUsername }}</div></div><div ng-switch-when="oauth"><div>{{ promptEmbedCredential }}</div><div>{{ datasource.connectionDetails.databaseUsername }}</div></div><div ng-switch-when="none">{{ promptNoCredential }}</div><div ng-if="oauthInitialEditModel.credentialOption === 'password' || oauthInitialEditModel.credentialOption === 'oauth'" class="tb-margin-top-wide"><span tb-button-click="testConnection($event)" tb-disabled="testConnectionResult.isPending || testConnectionDisabled()" tb-test-id="test-connection" class="tb-outline-button"><span ng-show="testConnectionResult.isPending" class="tb-icon-spinner tb-lr-padded-narrow"></span><span>测试连接</span></span><div class="tb-check-connection-result"><span ng-if="testConnectionResult.succeeded === true">成功连接到服务器</span><div ng-if="testConnectionResult.succeeded === false" class="tb-error-color"><div>无法连接到服务器</div><div ng-repeat="message in testConnectionResult.messages">{{ message }}</div></div></div></div></div><div ng-if="dataConnectionIsEditing()" ng-include="allowOAuthWithPassword ? 'editSalesforceConnectionDialog.html' : 'editOAuthConnectionDialog.html'"></div></td></tr><tr ng-if="canEditConnection" class="tb-more-actions"><td></td><td class="tb-inline-buttons"><span ng-show="dataConnectionIsReading()" tb-button-click="editOAuth()" tb-test-id="edit-data-connection" class="tb-outline-button">编辑连接</span><span ng-show="dataConnectionIsEditing()" tb-disabled="isSaving" tb-button-click="cancel()" tb-test-id="cancel-data-connection" class="tb-outline-button tb-cancel-button tb-margin-left-wide">取消</span><span ng-show="dataConnectionIsEditing()" tb-disabled="isSaving" tb-button-click="save()" tb-test-id="save-data-connection" class="tb-outline-button tb-go-button tb-margin-left-wide"><span ng-show="isSaving" class="tb-icon-spinner tb-lr-padded-narrow"></span><span>保存</span></span></td></tr></tbody></table><table ng-if="!datasource.connectionOAuth &amp;&amp; datasource.connectionDetails.type === 'database'"><tbody><tr><td class="tb-label">服务器名称</td><td class="tb-details-value"><span ng-if="dataConnectionIsReading()">{{ datasource.connectionDetails.serverName }}</span><tb:text-box tb-text-box-model="editModel.serverName" tb-text-box-required="true" tb-text-box-focus="true" tb-text-box-max-length="255" tb-test-id="connection-server-name" ng-if="dataConnectionIsEditing()"></tb:text-box></td><td class="tb-details-button-cell"><span tb-button-click="testConnection($event)" tb-disabled="requestTestConnectionIsDisabled() || testConnectionResult.isPending" tb-test-id="test-connection" class="tb-outline-button" ng-if="canEditConnection"><span ng-show="testConnectionResult.isPending" class="tb-icon-spinner tb-lr-padded-narrow"></span><span>测试连接</span></span></td><td><div class="tb-check-connection-result"><span ng-if="testConnectionResult.succeeded === true">成功连接到服务器</span><div ng-if="testConnectionResult.succeeded === false" class="tb-error-color"><div>无法连接到服务器</div><div ng-repeat="message in testConnectionResult.messages">{{ message }}</div></div></div></td></tr><tr><td class="tb-label">服务器端口</td><td class="tb-details-value"><span ng-if="dataConnectionIsReading()">{{ datasource.connectionDetails.serverPort }}</span><tb:text-box tb-text-box-model="editModel.serverPort" tb-text-box-validation="tb-port-input-validator" tb-test-id="connection-server-port" ng-if="dataConnectionIsEditing()"></tb:text-box></td><td class="tb-details-button-cell"></td></tr><tr><td class="tb-label">用户名</td><td class="tb-details-value"><span ng-if="dataConnectionIsReading()">{{ datasource.connectionDetails.databaseUsername }}</span><tb:text-box tb-text-box-model="editModel.username" tb-text-box-max-length="255" tb-test-id="connection-username" ng-if="dataConnectionIsEditing()"></tb:text-box></td><td class="tb-details-button-cell"></td></tr><tr><td class="tb-label">密码</td><td class="tb-details-value"><span ng-if="dataConnectionIsReading()"><span ng-show="!datasource.connectionDetails.hasEmbeddedPassword">如有必要提示用户输入密码</span><span ng-show="datasource.connectionDetails.hasEmbeddedPassword">嵌入连接中的密码</span></span><tb:embedded-password ng-if="dataConnectionIsEditing()" ng-model="editModel.password" tb-test-id="connection-password"></tb:embedded-password></td><td class="tb-details-button-cell"></td></tr><tr ng-if="canEditConnection" class="tb-more-actions"><td></td><td></td><td><span ng-show="dataConnectionIsReading()" tb-button-click="beginEdit()" tb-test-id="edit-data-connection" class="tb-outline-button">编辑连接</span><span ng-show="dataConnectionIsEditing()" tb-disabled="isSaving" tb-button-click="cancel()" tb-test-id="cancel-data-connection" class="tb-outline-button tb-cancel-button tb-margin-left-wide">取消</span><span ng-show="dataConnectionIsEditing()" tb-disabled="isSaving" tb-button-click="save()" tb-test-id="save-data-connection" class="tb-outline-button tb-go-button tb-margin-left-wide"><span ng-show="isSaving" class="tb-icon-spinner tb-lr-padded-narrow"></span><span>保存</span></span></td></tr></tbody></table></div>